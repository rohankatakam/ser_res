{
  "schema_version": "1.0",
  "constraints": [
    {
      "type": "sum_to_one",
      "params": [
        "stage_b.weight_similarity",
        "stage_b.weight_quality",
        "stage_b.weight_recency"
      ],
      "message": "Stage B scoring weights must sum to 1.0"
    }
  ],
  "groups": [
    {
      "id": "stage_a",
      "label": "Stage A: Quality Filtering",
      "description": "Parameters controlling the quality gate and candidate pool filtering",
      "collapsed": false,
      "params": [
        {
          "key": "stage_a.credibility_floor",
          "label": "Credibility Floor",
          "description": "Minimum credibility score (1-5) to include in candidate pool",
          "type": "int",
          "min": 0,
          "max": 5,
          "step": 1,
          "default": 2
        },
        {
          "key": "stage_a.combined_floor",
          "label": "Combined Floor (C+I)",
          "description": "Minimum sum of credibility + insight scores to pass quality gate",
          "type": "int",
          "min": 0,
          "max": 10,
          "step": 1,
          "default": 5
        },
        {
          "key": "stage_a.freshness_window_days",
          "label": "Freshness Window (days)",
          "description": "Only consider episodes published within this many days",
          "type": "int",
          "min": 7,
          "max": 365,
          "step": 7,
          "default": 90
        },
        {
          "key": "stage_a.candidate_pool_size",
          "label": "Candidate Pool Size",
          "description": "Maximum number of episodes to consider for ranking",
          "type": "int",
          "min": 50,
          "max": 500,
          "step": 10,
          "default": 150
        }
      ]
    },
    {
      "id": "stage_b",
      "label": "Stage B: Personalized Ranking",
      "description": "Weights and parameters for personalized scoring of candidates",
      "collapsed": false,
      "params": [
        {
          "key": "stage_b.weight_similarity",
          "label": "Similarity Weight",
          "description": "Weight for user-content similarity in final score (0-1)",
          "type": "float",
          "min": 0,
          "max": 1,
          "step": 0.05,
          "default": 0.85
        },
        {
          "key": "stage_b.weight_quality",
          "label": "Quality Weight",
          "description": "Weight for content quality in final score (0-1)",
          "type": "float",
          "min": 0,
          "max": 1,
          "step": 0.05,
          "default": 0.10
        },
        {
          "key": "stage_b.weight_recency",
          "label": "Recency Weight",
          "description": "Weight for content recency in final score (0-1)",
          "type": "float",
          "min": 0,
          "max": 1,
          "step": 0.05,
          "default": 0.05
        },
        {
          "key": "stage_b.user_vector_limit",
          "label": "User Vector Limit",
          "description": "Maximum number of engagements to use for user vector",
          "type": "int",
          "min": 1,
          "max": 50,
          "step": 1,
          "default": 10
        },
        {
          "key": "stage_b.credibility_multiplier",
          "label": "Credibility Multiplier",
          "description": "Bonus multiplier applied to credibility in quality score",
          "type": "float",
          "min": 1,
          "max": 3,
          "step": 0.1,
          "default": 1.5
        },
        {
          "key": "stage_b.recency_lambda",
          "label": "Recency Decay Lambda",
          "description": "Exponential decay rate for recency scoring (higher = faster decay)",
          "type": "float",
          "min": 0.01,
          "max": 0.1,
          "step": 0.01,
          "default": 0.03
        },
        {
          "key": "stage_b.use_weighted_engagements",
          "label": "Use Weighted Engagements",
          "description": "Weight engagements by type (bookmark > listen > click)",
          "type": "boolean",
          "default": true
        },
        {
          "key": "stage_b.use_sum_similarities",
          "label": "Use Sum-of-Similarities",
          "description": "Sum similarities to all engaged items (preserves diverse interests)",
          "type": "boolean",
          "default": true
        }
      ]
    },
    {
      "id": "engagement_weights",
      "label": "Engagement Weights",
      "description": "Relative weights for different engagement types",
      "collapsed": false,
      "params": [
        {
          "key": "engagement_weights.bookmark",
          "label": "Bookmark Weight",
          "description": "Weight multiplier for bookmark engagements",
          "type": "float",
          "min": 1,
          "max": 20,
          "step": 0.5,
          "default": 7.0
        },
        {
          "key": "engagement_weights.listen",
          "label": "Listen Weight",
          "description": "Weight multiplier for listen engagements",
          "type": "float",
          "min": 0.5,
          "max": 5,
          "step": 0.5,
          "default": 1.5
        },
        {
          "key": "engagement_weights.click",
          "label": "Click Weight",
          "description": "Weight multiplier for click engagements (baseline)",
          "type": "float",
          "min": 0.5,
          "max": 5,
          "step": 0.5,
          "default": 1.0
        }
      ]
    },
    {
      "id": "cold_start",
      "label": "Cold Start Behavior",
      "description": "Parameters for users with no engagement history",
      "collapsed": true,
      "params": [
        {
          "key": "cold_start.weight_quality",
          "label": "Quality Weight (Cold Start)",
          "description": "Weight for quality in cold start ranking (0-1)",
          "type": "float",
          "min": 0,
          "max": 1,
          "step": 0.05,
          "default": 0.60
        },
        {
          "key": "cold_start.weight_recency",
          "label": "Recency Weight (Cold Start)",
          "description": "Weight for recency in cold start ranking (0-1)",
          "type": "float",
          "min": 0,
          "max": 1,
          "step": 0.05,
          "default": 0.40
        }
      ]
    }
  ]
}
